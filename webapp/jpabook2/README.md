## ğŸ”¥ ì‹¤ì „! ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPA í™œìš©2 - API ê°œë°œê³¼ ì„±ëŠ¥ ìµœì í™”

---

### ğŸ í•´ë‹¹ ê°•ì˜ë¥¼ ì‹œì‘í•˜ëŠ” ì´ìœ  ?

* ì‹¤ì „! ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPA í™œìš©1 í¸ì„ ìˆ˜ê°•í•˜ë©´ì„œ ì´ì–´ì„œ ì§„í–‰ë˜ëŠ” ì‹¤ìŠµ ê°•ì˜ë¼ì„œ ì„ íƒí–ˆìŠµë‹ˆë‹¤.
  * ìš°ì„  1í¸ì—ì„œ ì–»ì€ ë‚´ìš©ì´ ë„ˆë¬´ ë§ì•˜ê¸° ë•Œë¬¸ì—, ë†“ì¹˜ê³  ì‹¶ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
  * 1í¸ì€ SSR(Server-Side-Rendering)ë°©ì‹ì˜ ê°œë°œ ì‹¤ìŠµì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.
  * 2í¸ì€ API ìœ„ì£¼ ë°©ì‹ì˜ ê°œë°œ ì‹¤ìŠµì„ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. 
  * íŠ¸ë Œë“œëŠ” ì£¼ë¡œ APIë¥¼ ì´ìš©í•´ í†µì‹ í•˜ë¯€ë¡œ ì‹¤ë¬´ì—ì„œëŠ” ì–´ë–»ê²Œ APIë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì„ì§€ ì•Œ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.
* ìŠ¤ìŠ¤ë¡œ ëŠë¼ê¸°ì— 1í¸ì€ í”„ë¡œì íŠ¸ì˜ MVP(Minimum Viable Product) ì œì‘ì— ì´ˆì ì´ ë§ì¶°ì§„ ëŠë‚Œì…ë‹ˆë‹¤.
  * 2í¸ì€ MVPë¡œ ì‘ì„±ëœ ì„œë¹„ìŠ¤ë¥¼ JPAì˜ ì„±ëŠ¥ì„ ìµœì í™” í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ í•™ìŠµí•  ìˆ˜ ìˆë‹¤ê³  í•©ë‹ˆë‹¤.
  * 1í¸ì—ì„œ ì–¸ê¸‰ëœ ì  ìˆë˜ N+1 ë¬¸ì œ, N:M ë§¤í•‘ì˜ ë‹¨ì  ë“±ì„ ë³´ì™„í•˜ëŠ” ë°©ë²•ë“¤ì„ í•™ìŠµí•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.

### ğŸ” í•´ë‹¹ ê°•ì˜ë¥¼ ìˆ˜ê°•í•œ ë’¤ ì–»ì„ ìˆ˜ ìˆëŠ” ê²°ê³¼ë¬¼ ?
    
* ê¸°ì¡´ì— ì•Œê³  ìˆë˜ API ê°œë°œì˜ ë¶€ì¡±í•œ ê°œë…ì´ ìˆì—ˆë‹¤ë©´, ë³´ì™„í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
* ì‹¤ìŠµ í”„ë¡œì íŠ¸ë¡œ ì„±ëŠ¥ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì¼€ì´ìŠ¤ë“¤ì„ ê²½í—˜í•´ ë³¼ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
* í˜„ì¬ ì§„í–‰ì¤‘ì¸ í”„ë¡œì íŠ¸ì—ì„œ ê°œì„ í•  ë¶€ë¶„ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.

### ğŸ“ í•™ìŠµ í›„ ì–»ê²Œëœ ë‚´ìš©

- 1í¸ ê°•ì˜ì— ëŒ€í•´ ì •ë¦¬í•œ ë‚´ìš© ì¤‘ fetch ì „ëµì— ëŒ€í•´ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ë©´ì„œ ìŠ¤ìŠ¤ë¡œ ê¹¨ë‹«ê²Œ ëœ ë‚´ìš© ì¤‘ N+1 ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, N+1ì´ ë¬´ì¡°ê±´ ë‚˜ìœ ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ê²ƒì„ ì´ë²ˆ ê°•ì˜ë¥¼ í†µí•´ ì•Œê²ŒëìŠµë‹ˆë‹¤.
  - Lazy ê°•ì œ ì´ˆê¸°í™”ë¥¼ í†µí•´ JPAì—ê²Œ ì±…ì„ì„ ë¶€ì—¬í•˜ëŠ” ë°©ë²•ì€ N+1 ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ, ë°ì´í„°ëŸ‰ì— ë”°ë¼ ì„±ëŠ¥ ì°¨ì´ê°€ ì ê³  ì˜¤íˆë ¤ ê°œë°œ ì†ë„ë¥¼ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆëŠ” ì¥ì ë„ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
  - 1í¸ ì •ë¦¬ ë§í¬ - ([README](https://github.com/jihwankim128/yeonghan/tree/main/webapp/jpabook), [ë¸”ë¡œê·¸ ì •ë¦¬](https://velog.io/@jihwankim128/AI-Carrer-School-12%EC%A3%BC-%EC%B0%A8-%ED%95%99%EC%8A%B5-%EA%B2%B0%EA%B3%BC))
- ì¡°íšŒ ì‘ì—… ì‹œ JPAì—ì„œ Entityë¡œ ì¡°íšŒí•œ ë’¤ DTOë¡œ ë³€í™˜í•˜ëŠ” ë°©ì‹ê³¼ JPAì—ì„œ ì§ì ‘ DTOë¡œ ë§¤í•‘í•˜ëŠ” ë°©ì‹ì˜ ì¥ë‹¨ì ì„ ì•Œê²ŒëìŠµë‹ˆë‹¤.
  - JPA To Entity
    - ì¥ì : JPAì˜ ì¶”ìƒí™© ê¸°ìˆ ì„ ìµœëŒ€í•œ í™œìš©í•´ì„œ ë¹„êµì  ê°„ë‹¨í•˜ê²Œ ì¿¼ë¦¬ ì‘ì—…ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ë‹¨ì : DBëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œì´ë¯€ë¡œ ì ‘ê·¼í•˜ë ¤ë©´ Networkë¥¼ íƒ€ì•¼í•˜ê³  ì‹¤ì œ DataëŠ” row levelì— ì¡´ì¬í•˜ë¯€ë¡œ ë°ì´í„° ì´ë™ ê°„ í•„ìš” ì—†ëŠ” í•„ë“œëŠ” ì¶”ê°€ ë¹„ìš©ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - JPA To DTO
    - ì¥ì : Client ì¸¡ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” ìµœì†Œí•œì˜ í•„ë“œ ì •ë³´ë¡œ DBì™€ í†µì‹  ê°„ Network ë¹„ìš©ì´ ìµœì  ìƒíƒœê°€ ë©ë‹ˆë‹¤.
    - ë‹¨ì : JPAì˜ ì¶”ìƒí™” ê¸°ìˆ ì„ ìµœëŒ€í•œ í™œìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë˜, Client ì¸¡ì— ë¹ˆë²ˆí•œ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ë§ˆì°¬ê°€ì§€ë¡œ ë¹ˆë²ˆí•œ ìˆ˜ì •ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ìƒí™© ë³„ ì„ íƒ
    - MSAë¥¼ ë„ì… í–ˆì„ ë•Œ, ê° ëª¨ë“ˆ ê°„ API í†µì‹ ìœ¼ë¡œ íŠ¹ì • ë„ë©”ì¸ì˜ ì „ì²´ ìŠ¤í™ì´ í•„ìš”í•  ê²½ìš° JPA To Entity ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
    - ê²Œì‹œê¸€ ì‚­ì œ ì‹œ, ê´€ë ¨ëœ ëŒ“ê¸€ë“¤ì„ ëª¨ë‘ Soft Delete í•˜ëŠ” ë°©ì‹ê³¼ ê°™ì´ Service Layerì—ì„œ ì˜ì¡´ëœ ë„ë©”ì¸ ê°„ ì¶”ê°€ì‘ì—…ì´ ë°œìƒí•  ë•Œ, JPA To Entity ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
    - UIì— ë§ëŠ” API ìŠ¤í™ì´ í•„ìš”í•  ë•ŒëŠ” JPA To DTO ë°©ì‹ì´ ì¢‹ê² ìŠµë‹ˆë‹¤. Queryì™€ Commandë¥¼ ë¶„ë¦¬í•˜ëŠ” ì¥ì ì„ ì±™ê¸°ë©´ì„œ UIê°€ ë°”ë€Œë”ë¼ë„ Queryê°€ ê´€ë ¨ëœ í´ë˜ìŠ¤ë§Œ ìˆ˜ì •í•˜ë©´ ë˜ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.
 - hibernate.default_batch_fetch_size ì˜µì…˜ì— ëŒ€í•´ì„œ ëª…í™•íˆ ì´í•´í–ˆìŠµë‹ˆë‹¤.
   - ê¸°ì¡´ì—ëŠ” ê´€ë¡€ì²˜ëŸ¼ ê·¸ëƒ¥ ì‚¬ìš©í•˜ë˜ ìŠµê´€ì´ ìˆì—ˆëŠ”ë° ì´ë¥¼ í†µí•´ì„œ fetchë¥¼ ìœ„í•œ JPQLì„ ë”°ë¡œ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ JPA ì¶”ìƒí™” ê¸°ìˆ ì„ í†µí•´ N+1 ë¬¸ì œë¥¼ ì™„í™” í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²ŒëìŠµë‹ˆë‹¤.
 - ë„ë©”ì¸ ê°„ ì—°ê´€ê´€ê³„ê°€ 1:N ì¼ ë•Œ, Nì—ì„œ í•œë²ˆ ë” 1:Nì˜ ì—°ê´€ê´€ê³„ê°€ ìˆë‹¤ë©´ ì¿¼ë¦¬ë¥¼ ë¶„ë¦¬í•´ì•¼ ëœë‹¤.
   - 1:N ê´€ê³„ëŠ” Nê´€ê³„ì—ì„œ 1ì— ëŒ€í•œ ì‹ë³„ ì •ë³´ë¥¼ ì•Œê³  ìˆê¸° ë•Œë¬¸ì— join ì ˆì—ì„œ ì˜ˆìƒí•˜ëŠ” query ìˆ˜ê°€ ë‚˜ì˜¨ë‹¤.
   - í›„ìì˜ ìƒí™©ì—ì„œëŠ” 1:N:M ìƒí™©ì´ë¯€ë¡œ Mì´ 1ì— ëŒ€í•œ ì‹ë³„ ì •ë³´ê°€ ì—†ë‹¤ë©´ 1ì— ëŒ€í•œ query * Mì— ëŒ€í•œ query ë§Œí¼ ì¶”ê°€ queryê°€ ìƒì„±ëœë‹¤.
 - OSIV(Open Session In View)ë¥¼ í™œìš©í•´ì•¼í•œë‹¤.
   - Transaction Isolationì´ Service + Repository Layer ë¿ë§Œ ì•„ë‹ˆë¼ Controller Layerê¹Œì§€ ì˜í–¥ì„ ë¯¸ì¹œë‹¤.
   - OSIVë¥¼ í™œì„±í™” í•œë‹¤ë©´, íŠ¸ëœì­ì…˜ ë²”ìœ„ ë•Œë¬¸ì— DB Connectionì„ ë” ê´‘ë²”ìœ„í•˜ê²Œ ê°€ì ¸ê°„ë‹¤. íŠ¸ë˜í”½ì´ ë§ì•„ì§ˆìˆ˜ë¡ DB ë°˜í™˜ ì†ë„ê°€ ëŠë ¤ì§ˆ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.
   - OSIVë¥¼ ë¹„í™œì„±í™” í•œë‹¤ë©´, Controller Layerì™€ Service + Repository Layer ì— ëŒ€í•œ ì±…ì„ì„ ì™„ì „íˆ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.
   - ë§Œì•½ OSIVë¥¼ ê³„ì†í•´ì„œ í™œì„±í™”í•˜ê³  ì‘ì—…í•˜ë‹¤ê°€ íŒ€ì› ì¤‘ Controller Layerì™€ Service Layerì˜ ê²½ê³„ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•˜ì§€ ëª»í•˜ê³  Controllerì—ì„œ Lazy Loadingì„ í™œìš©í•˜ê³  ìˆë‹¤ê³  ìƒê°í•´ë³´ì.
     - ì¶”í›„ íŠ¸ë˜í”½ì´ ë§ì•„ì ¸ì„œ DB Connectionì´ ëŠ¦ê²Œ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ê¹¨ë‹«ê³  OSIVë¥¼ ë¹„í™œì„±í™”í•˜ì§€ë§Œ, ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•  ë‚´ìš© ë˜í•œ ë§ì•„ì§ˆ ê²ƒì´ë‹¤.
     - í”„ë¡œì íŠ¸ ì‹œì‘ë¶€í„° OSIVë¥¼ ë„ëŠ” ê²ƒì€ ì¢‹ì€ ìŠµê´€ì¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤.
### ì†Œê°

- ì´ë²ˆ ê°•ì˜ëŠ” ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œ ê°€ì¥ ë§ì€ íŠ¸ë˜í”½ì´ ë°œìƒí•˜ëŠ” ì¡°íšŒì— ëŒ€í•œ ìµœì í™” ê¸°ìˆ ì´ ë§ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. ê°•ì˜ë¥¼ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•  ë•Œ, MVP ê°œë°œ ìƒí™©, ì¶”í›„ ì„œë¹„ìŠ¤ ì‘ë‹µ ì†ë„ í–¥ìƒì„ ìœ„í•œ ë¦¬íŒ©í† ë§ ë“±ì—ì„œ ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ JPA ê¸°ìˆ ì„ ì ìš©í•´ì•¼ ë  ì§€ ê¹¨ë‹«ê²Œ ë˜ëŠ” ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.

### í•™ìŠµ í™˜ê²½

> ê°•ì˜ì™€ ë‹¬ë¦¬ í˜„ì¬ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ë¡œ í•™ìŠµì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

- Gradle 8.11.1
- Spring Boot 3.4.1
- Java 21
- H2 DB

### ê°•ì˜ ì •ë³´

- ì¸í”„ëŸ° í•™ìŠµ ë§í¬ : https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-API%EA%B0%9C%EB%B0%9C-%EC%84%B1%EB%8A%A5%EC%B5%9C%EC%A0%81%ED%99%94

### í•™ìŠµ ì •ë¦¬

- Velog : https://velog.io/@jihwankim128/AI-Carrer-School-%ED%95%99%EC%8A%B5-%EA%B2%B0%EA%B3%BC2
